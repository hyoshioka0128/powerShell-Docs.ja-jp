---
ms.date: 09/13/2016
ms.topic: reference
title: PowerShell スクリプトと関数のヘルプの作成
description: PowerShell スクリプトと関数のヘルプの作成
ms.openlocfilehash: f72742e2a131f41ba8ffdcec4901c7c3ea1da1ad
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/10/2020
ms.locfileid: "92654634"
---
# <a name="writing-help-for-powershell-scripts-and-functions"></a>PowerShell スクリプトと関数のヘルプの作成

PowerShell スクリプトと関数は、他のユーザーと共有されるたびに、完全に文書化する必要があります。
コマンドレットでは、 `Get-Help` コマンドレットのヘルプを表示するのと同じ形式でスクリプトと関数のヘルプトピックを表示します。すべてのパラメーターは、 `Get-Help` スクリプトと関数のヘルプトピックで動作します。

PowerShell スクリプトには、スクリプトの各関数に関するスクリプトとヘルプトピックに関するヘルプトピックを含めることができます。 スクリプトとは無関係に共有される関数には、独自のヘルプトピックを含めることができます。

このドキュメントでは、ヘルプトピックの形式と正しい配置について説明し、コンテンツのガイドラインを提示します。

## <a name="types-of-script-and-function-help"></a>スクリプトと関数のヘルプの種類

### <a name="comment-based-help"></a>コメント ベースのヘルプ

スクリプトまたは関数について説明するヘルプトピックは、スクリプトまたは関数内の一連のコメントとして実装できます。 スクリプトおよびスクリプト内の関数のコメントベースのヘルプを作成する場合は、コメントベースのヘルプを配置するための規則に注意してください。 配置では、 `Get-Help` コマンドレットがヘルプトピックをスクリプトまたは関数に関連付けるかどうかを決定します。 コメントベースのヘルプトピックの記述の詳細については、「 [about_Comment_Based_Help](/powershell/module/microsoft.powershell.core/about/about_comment_based_help)」を参照してください。

### <a name="xml-based-command-help"></a>XML-Based コマンドのヘルプ

スクリプトまたは関数について説明するヘルプトピックは、コマンドヘルプスキーマを使用する XML ファイルに実装できます。 スクリプトまたは関数を XML ファイルに関連付けるには、 `ExternalHelp` コメントキーワードの後に xml ファイルのパスと名前を指定します。

`ExternalHelp`Comment キーワードが存在する場合は、 `Get-Help` キーワードの値に一致するヘルプファイルが見つからない場合でも、コメントベースのヘルプよりも優先され `ExternalHelp` ます。

### <a name="online-help"></a>オンライン ヘルプ

インターネット上にヘルプトピックを投稿し、そのトピックを `Get-Help` 開くように指示できます。 コメントベースのヘルプトピックの記述の詳細については、「 [オンラインヘルプのサポート](../module/supporting-online-help.md)」を参照してください。

スクリプトと関数に関する概念 ("About") トピックを記述するための方法は確立されていません。
ただし、コマンドのヘルプトピックの「関連リンク」セクションに、トピックとその Url を記載した概念説明のトピックをインターネットに掲載することができます。

## <a name="content-considerations-for-script-and-function-help"></a>スクリプトと関数のヘルプに関するコンテンツに関する考慮事項

- 使用できるコマンドのヘルプセクションの一部だけを含む非常に短いヘルプトピックを作成する場合は、スクリプトまたは関数のパラメーターについて明確に説明するようにしてください。 また、例の説明を省略する場合でも、1つまたは2つのサンプルコマンドを例のセクションに含めます。

- すべての説明で、スクリプトまたは関数としてコマンドを参照してください。 この情報は、ユーザーがコマンドを理解し、管理するのに役立ちます。

  たとえば、次の詳細な説明は、New-Topic コマンドがスクリプトであることを示しています。
  これにより、ユーザーが実行時にパスと完全名を指定する必要があることがユーザーに通知されます。

  > 「New-Topic スクリプトは、入力ファイル内の各トピック名に対して空の概念トピックを作成します。」

  次に示すのは、関数である詳細な説明です `Disable-PSRemoting` 。 この情報は、セッションに同じ名前の複数のコマンドが含まれていて、優先順位の高いコマンドによって非表示になっている可能性がある場合に、ユーザーにとって特に便利です。

  > 関数は、 `Disable-PSRemoting` ローカルコンピューター上のすべてのセッション構成を無効にします...

- スクリプトのヘルプトピックでは、スクリプト全体の使用方法について説明します。 スクリプト内の関数に関するヘルプトピックを作成する場合は、スクリプトのヘルプトピックにある関数について説明し、スクリプトヘルプトピックの「関連リンク」セクションの関数ヘルプトピックへの参照を含めてください。
  逆に、関数がスクリプトの一部である場合は、関数がスクリプトで果たす役割と、その関数が個別に使用される方法について、関数のヘルプトピックで説明します。 次に、関数のヘルプトピックの「関連リンク」セクションで、スクリプトのヘルプトピックを一覧表示します。

- スクリプトのヘルプトピックの例を記述するときは、スクリプトファイルへのパスを例のコマンドに含めてください。 これにより、スクリプトが現在のディレクトリにある場合でも、パスを明示的に指定する必要があることがユーザーに通知されます。

- 関数のヘルプトピックでは、関数が現在のセッションにのみ存在することをユーザーに通知し、他のセッションで使用するには、その機能を追加するか、PowerShell プロファイルに追加する必要があります。

- `Get-Help` スクリプトファイルおよびヘルプトピックファイルが正しい場所に保存されている場合にのみ、スクリプトまたは関数のヘルプトピックを表示します。 そのため、PowerShell のインストール手順を含めたり、スクリプトや関数をスクリプトまたは関数のヘルプトピックに保存したりインストールしたりすることはできません。 代わりに、スクリプトまたは関数の配布に使用するすべてのインストール手順をドキュメントに含めます。

## <a name="see-also"></a>参照

[コメントベースのヘルプ トピックを記述する](./writing-comment-based-help-topics.md)
