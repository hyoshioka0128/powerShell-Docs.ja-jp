---
ms.date: 09/10/2018
title: API キーの管理
description: PowerShell ギャラリーでは、ギャラリーに対するコンテンツ公開元のアクセスを認証するために、API キーが使用されます。
ms.openlocfilehash: 4b70ac7d56fc1d63719c2acf93da3dd4ac22abed
ms.sourcegitcommit: 488a940c7c828820b36a6ba56c119f64614afc29
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/27/2020
ms.locfileid: "92661133"
---
# <a name="managing-api-keys"></a>API キーの管理

PowerShell ギャラリーでは、さまざまな公開要件をサポートするために複数の API キーの作成をサポートしています。 1 つの API キーを 1 つ以上のパッケージに適用することができます。API キーには特定の権限を付与でき、有効期限があります。

> [!IMPORTANT]
> スコープ付き API キーの導入前に PowerShell ギャラリーに公開したユーザーは、"フル アクセス API キー" を持ちます。 フル アクセス キーには、スコープ付きの API キーに組み込まれているセキュリティ強化はありません。 フル アクセス キーには有効期限はなく、ユーザーが所有するすべてのものに適用されます。 このキーを削除すると、再作成することはできません。

次の図は、スコープ付き API キーを作成するときに使用できるオプションを示しています。

![API キーの作成](media/creating-APIkeys/PSGallery_KeyScoped.png)

この例では、 **AzureRMDataFactory** という名前の API キーを作成しました。 このキーの値は、'AzureRM.DataFactory' で始まる名前を持つパッケージをプッシュするために使用でき、365 日間有効です。 これは、同じ組織内の別のチームが異なるパッケージで作業する場合の一般的なシナリオです。 チームのメンバーは、作業する特定のパッケージに対する特権を付与するキーを持ちます。
有効期限の値により、古いキーや忘れられたキーの使用を防止します。

## <a name="using-glob-patterns"></a>glob パターンを使用する

複数のパッケージで作業する場合、glob パターンを使用して複数のパッケージをグループとして一致させることができます。 glob パターンに一致するすべての新しいパッケージに API キーのアクセス許可が適用されます。 たとえば、前の例では、 **glob パターン** 値に 'AzureRM.DataFactory*' を使用しています。 パッケージが glob パターンと一致するため、このキーを使用して 'AzureRm.DataFactoryV2.Netcore' という名前のパッケージをプッシュすることができます。

## <a name="create-api-keys-securely"></a>API キーを安全に作成する

セキュリティのため、新しく作成されたキー値は画面に表示されず、次に示すように [コピー] ボタンを使用してのみ入手できます。

![新しい API キー値を取得する](media/creating-APIkeys/PSGallery_CopyCreatedKey.png)

> [!IMPORTANT]
> API キー値は、作成直後または更新直後にのみコピーできます。 キー値は表示されず、ページを更新すると、もう一度アクセスすることはできなくなります。 キー値を紛失した場合は、[再生成] を使用して、再生成された後にキーをコピーする必要があります。

## <a name="key-permissions-and-expiration"></a>キーのアクセス許可と有効期限

スコープ付き API キーには、次のアクセス許可のいずれかを割り当てることができます。

- 新しいパッケージをプッシュする
- 新しいパッケージをプッシュまたはパッケージを更新する
- パッケージを一覧から削除する

新しいキーにはすべて有効期限があります。 有効期限の値の単位は日です。 有効期限の有効な値は次のとおりです。

- 1 日
- 90 日間
- 180 日
- 270 日
- 365 日 (既定値)

キーが作成されたら、これらの設定を変更することはできません。 有効期限のない新しいキーを作成することはできません。

## <a name="editing-and-deleting-existing-api-keys"></a>既存の API キーの編集と削除

既存のキーの一部の設定を変更することができます。 前述したように、既存の API キーのセキュリティ スコープを変更したり、有効期限を変更することはできません。 変更可能なオプションは、次のスクリーンショットに示されているとおりです。

![API キー値の編集](media/creating-APIkeys/PSGallery_EditAPIKey.png)

キーによって制御されるパッケージを変更するには、一覧から個々のパッケージを選択するか、glob パターンを変更します。

**[再生成]** をクリックすると、新しいキー値が作成されます。 キーを最初に作成したときと同じく、更新後すぐにキー値を **コピー** する必要があります。 このページから移動すると、 **[コピー]** オプションは使用できなくなります。

**[削除]** をクリックすると、確認メッセージが表示されます。 キーが削除されると、そのキーは使用できなくなります。

## <a name="key-expiration"></a>キーの有効期限

有効期限の 10 日前に、PowerShell ギャラリーから警告メールが API キーのアカウント所有者に送信されます。 有効期限を過ぎると、キーは使用できなくなります。 API キーの管理ページの上部に、キーが無効になったことを示す警告メッセージが表示されます。 新しいキー値を生成することができます。
